<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Votaciones EurovisiÃ³n 2025</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>Votaciones EurovisiÃ³n 2025</h1>
    <form id="voteForm">
      <input type="text" id="name" placeholder="Tu nombre" required />
      <select id="country" required>
        <option value="" disabled selected>Selecciona un paÃ­s</option>
        <option value="Noruega ğŸ‡³ğŸ‡´ - Kyle Alessandro - Lighter">ğŸ‡³ğŸ‡´ Noruega - Kyle Alessandro - Â«LighterÂ»</option>
        <option value="Luxemburgo ğŸ‡±ğŸ‡º - Laura Thorn - La poupÃ©e monte le son">ğŸ‡±ğŸ‡º Luxemburgo - Laura Thorn - Â«La poupÃ©e monte le sonÂ»</option>
        <option value="Estonia ğŸ‡ªğŸ‡ª - Tommy Cash - Espresso Macchiato">ğŸ‡ªğŸ‡ª Estonia - Tommy Cash - Â«Espresso MacchiatoÂ»</option>
        <option value="Israel ğŸ‡®ğŸ‡± - Yuval Raphael - New day will rise">ğŸ‡®ğŸ‡± Israel - Yuval Raphael - Â«New day will riseÂ»</option>
        <option value="Lituania ğŸ‡±ğŸ‡¹ - Katarsis - Tavo akys">ğŸ‡±ğŸ‡¹ Lituania - Katarsis - Â«Tavo akysÂ»</option>
        <option value="EspaÃ±a ğŸ‡ªğŸ‡¸ - Melody - Esa diva">ğŸ‡ªğŸ‡¸ EspaÃ±a - Melody - Â«Esa divaÂ»</option>
        <option value="Ucrania ğŸ‡ºğŸ‡¦ - Ziferblat - Bird of Pray">ğŸ‡ºğŸ‡¦ Ucrania - Ziferblat - Â«Bird of PrayÂ»</option>
        <option value="Reino Unido ğŸ‡¬ğŸ‡§ - Remember Monday - What the hell just happened?">ğŸ‡¬ğŸ‡§ Reino Unido - Remember Monday - Â«What the hell just happened?Â»</option>
        <option value="Austria ğŸ‡¦ğŸ‡¹ - JJ - Wasted Love">ğŸ‡¦ğŸ‡¹ Austria - JJ - Â«Wasted LoveÂ»</option>
        <option value="Islandia ğŸ‡®ğŸ‡¸ - VÃ¦b - RÃ“A">ğŸ‡®ğŸ‡¸ Islandia - VÃ¦b - Â«RÃ“AÂ»</option>
        <option value="Letonia ğŸ‡±ğŸ‡» - Tautumeitas - Bur man laimi">ğŸ‡±ğŸ‡» Letonia - Tautumeitas - Â«Bur man laimiÂ»</option>
        <option value="PaÃ­ses Bajos ğŸ‡³ğŸ‡± - Claude - C'est la vie">ğŸ‡³ğŸ‡± PaÃ­ses Bajos - Claude - Â«C'est la vieÂ»</option>
        <option value="Finlandia ğŸ‡«ğŸ‡® - Erika Vikman - Ich komme">ğŸ‡«ğŸ‡® Finlandia - Erika Vikman - Â«Ich kommeÂ»</option>
        <option value="Italia ğŸ‡®ğŸ‡¹ - Lucio Corsi - Volevo essere un duro">ğŸ‡®ğŸ‡¹ Italia - Lucio Corsi - Â«Volevo essere un duroÂ»</option>
        <option value="Polonia ğŸ‡µğŸ‡± - Justyna Steczkowska - Gaja">ğŸ‡µğŸ‡± Polonia - Justyna Steczkowska - Â«GajaÂ»</option>
        <option value="Alemania ğŸ‡©ğŸ‡ª - Abor & Tynna - Baller">ğŸ‡©ğŸ‡ª Alemania - Abor & Tynna - Â«BallerÂ»</option>
        <option value="Grecia ğŸ‡¬ğŸ‡· - Klavdia - AsteromÃ¡ta">ğŸ‡¬ğŸ‡· Grecia - Klavdia - Â«AsteromÃ¡taÂ»</option>
        <option value="Armenia ğŸ‡¦ğŸ‡² - Parg - Survivor">ğŸ‡¦ğŸ‡² Armenia - Parg - Â«SurvivorÂ»</option>
        <option value="Suiza ğŸ‡¨ğŸ‡­ - ZoÃ« MÃ« - Voyage">ğŸ‡¨ğŸ‡­ Suiza - ZoÃ« MÃ« - Â«VoyageÂ»</option>
        <option value="Malta ğŸ‡²ğŸ‡¹ - Miriana Conte - Serving">ğŸ‡²ğŸ‡¹ Malta - Miriana Conte - Â«ServingÂ»</option>
        <option value="Portugal ğŸ‡µğŸ‡¹ - Napa - Deslocado">ğŸ‡µğŸ‡¹ Portugal - Napa - Â«DeslocadoÂ»</option>
        <option value="Dinamarca ğŸ‡©ğŸ‡° - Sissal - Hallucination">ğŸ‡©ğŸ‡° Dinamarca - Sissal - Â«HallucinationÂ»</option>
        <option value="Suecia ğŸ‡¸ğŸ‡ª - KAJ - Bara bada bastu">ğŸ‡¸ğŸ‡ª Suecia - KAJ - Â«Bara bada bastuÂ»</option>
        <option value="Francia ğŸ‡«ğŸ‡· - Louane - Maman">ğŸ‡«ğŸ‡· Francia - Louane - Â«MamanÂ»</option>
        <option value="San Marino ğŸ‡¸ğŸ‡² - Gabry Ponte - Tutta l'Italia">ğŸ‡¸ğŸ‡² San Marino - Gabry Ponte - Â«Tutta l'ItaliaÂ»</option>
        <option value="Albania ğŸ‡¦ğŸ‡± - Shkodra Elektronike - Zjerm">ğŸ‡¦ğŸ‡± Albania - Shkodra Elektronike - Â«ZjermÂ»</option>
      </select>
      <button type="submit">Votar</button>
    </form>

    <h2>Resultados en vivo</h2>
    <ul id="resultsList">Cargando resultados...</ul>
  </div>

  <script>
    const voteForm = document.getElementById("voteForm");
    const resultsList = document.getElementById("resultsList");

    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzBNZ1x074LszOoVNIUogeB7Cgv43PiwabwB73HBe2LiFwDby6RIEnQqiFNQpeW2IvQsw/exec";

    voteForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("name").value.trim();
      const country = document.getElementById("country").value;

      if (!name || !country) return;

      const voteData = { name, country };

      await fetch(GOOGLE_SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify(voteData),
        headers: {
          "Content-Type": "application/json",
        },
      });

      voteForm.reset();
      alert("Â¡Voto enviado!");
    });

    async function getResultsFromSheet() {
      const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTlWW2frQC17TbpRh6jf99xBIaRhEKvLxniz8kEeoLUXLnI4EgFCBug-NM7dOAjSW4b9TJD9llqPbrc/pub?gid=0&single=true&output=csv"; // Lo explico abajo
      const response = await fetch(sheetURL);
      const text = await response.text();

      const lines = text.trim().split("\n").slice(1); // Skip headers
      const counts = {};

      for (let line of lines) {
        const [name, country] = line.split(",");
        counts[country] = (counts[country] || 0) + 1;
      }

      const sorted = Object.entries(counts).sort((a, b) => b[1] - a[1]);
      resultsList.innerHTML = "";
      sorted.forEach(([country, votes]) => {
        const li = document.createElement("li");
        li.textContent = `${country}: ${votes} voto(s)`;
        resultsList.appendChild(li);
      });
    }

    // Actualizar cada 5 segundos
    setInterval(getResultsFromSheet, 5000);
    getResultsFromSheet();
  </script>
</body>
</html>
